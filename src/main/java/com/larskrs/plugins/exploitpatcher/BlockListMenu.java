package com.larskrs.plugins.exploitpatcher;

import com.larskrs.plugins.exploitpatcher.tools.XMaterial;
import org.bukkit.Bukkit;
import org.bukkit.Material;
import org.bukkit.entity.Entity;
import org.bukkit.entity.EntityType;
import org.bukkit.entity.Item;
import org.bukkit.entity.Player;
import org.bukkit.inventory.Inventory;
import org.bukkit.inventory.ItemStack;
import org.bukkit.inventory.meta.ItemMeta;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collections;
import java.util.List;

public class BlockListMenu {

    private ExploitPatcher exploitPatcher;

    public static int Page;

    public BlockListMenu(Player player, int page) {


        Inventory gui = Bukkit.createInventory(null, 54, "Ban Block - " + page);

        List<ItemStack> Items = new ArrayList<ItemStack>();
        Page = page;

        for (XMaterial mat: XMaterial.values()) {

            if (mat != null && mat.parseMaterial() !=null) {
                if (!config.getBlockedBlocks().contains(mat.name())) {
                    ItemStack is = mat.parseItem();
                    ItemMeta im = is.getItemMeta();
                    is.setItemMeta(im);
                    if (im != null) {
                        im.setDisplayName(mat.name());
                        is.setItemMeta(im);
                        Items.add(is);
                    }
                }
                    else {
                        // if block is disabled
                        ItemStack is = XMaterial.RED_STAINED_GLASS_PANE.parseItem();
                        ItemMeta im = is.getItemMeta();
                        im.setDisplayName(mat.name());
                        is.setItemMeta(im);
                        Items.add(is);
                    }


            }
        }

        ItemStack left;
        ItemMeta leftMeta;
        if (MenuPageUtil.isPageValid(Items, page - 1, 45)) { // GO back page button.
            left = XMaterial.ARROW.parseItem();
            leftMeta = left.getItemMeta();
            leftMeta.setDisplayName("§b§lLast Page");
        } else {
            left = XMaterial.LIGHT_GRAY_STAINED_GLASS_PANE.parseItem();
            leftMeta = left.getItemMeta();
            leftMeta.setDisplayName("§cNo more pages.");
        }
        // Set page to public variable.



        left.setItemMeta(leftMeta);

        gui.setItem(45, left);


        ItemStack right;
        ItemMeta rightMeta;
        if (MenuPageUtil.isPageValid(Items, page + 1, 45)) { // GO back page button.
            right = XMaterial.ARROW.parseItem();
            rightMeta = right.getItemMeta();
            rightMeta.setDisplayName("§b§lNext Page");
            right.setItemMeta(rightMeta);
        } else {
            right = XMaterial.LIGHT_GRAY_STAINED_GLASS_PANE.parseItem();
            rightMeta = right.getItemMeta();
            rightMeta.setDisplayName("§cNo more pages.");

        }

        ItemStack clear;
        ItemMeta clearMeta;
        clear = XMaterial.BUCKET.parseItem();
        clearMeta = right.getItemMeta();
        clearMeta.setDisplayName("§cClear Banned Entities");
        clear.setItemMeta(clearMeta);



        right.setItemMeta(rightMeta);

        gui.setItem(53, right);
        gui.setItem(49, clear);


        for (ItemStack itemStack: MenuPageUtil.getPageItems(Items, page, 36)) {
            gui.setItem(gui.firstEmpty(), itemStack);
        }

        player.openInventory(gui);

    }
}
